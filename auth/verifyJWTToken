const jwt = require('jsonwebtoken');

const verifyJWTToken = function (token) {
    return new Promise((resolve, reject) => {
        jwt.verify(token, process.env.JWT_SECRET, (err, decodedToken) => {
            if (err || !decodedToken) {
                return reject(err)
            }

            resolve(decodedToken)
        })
    })
};

module.exports = verifyJWTToken;


// example:
// testToken = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRlc3RVc2VybmFtZTE4IiwiZGF0YSI6e30sImlhdCI6MTUyMjM1NTA1MSwiZXhwIjoxNTIyMzU4NjUxfQ.Y3YKDtql0PsGcsTTgIf2EXAV2c-vWhRfQh8eSxvxxHo";
// verifyJWTToken(testToken).then((decodedToken) => {
//     console.log(decodedToken)
// });

